# ğŸ“¢ ì†Œì…œ ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ ê°œë°œ í”„ë¡œì íŠ¸ 2ì°¨

> ì°¸ê³  : <u>**[ì†Œì…œ ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ ê°œë°œ í”„ë¡œì íŠ¸ 1ì°¨](https://github.com/likelion-backend-6th/TrackProject_1_ChoiSeonWoo)</u> repository**

<br>


## í•˜ë‹¨ ë‚´ìš©ì€ `2ì°¨` ê°œë°œ ë‚´ìš©ì— ë§ê²Œ  ì¶”í›„ ìˆ˜ì • ì˜ˆì •



<br>

## ğŸ—’ï¸ í”„ë¡œì íŠ¸ ê°œìš”
- Python, Djangoë¥¼ ì´ìš©í•œ ì†Œì…œ ë„¤íŠ¸ì›Œí¬ ì„œë¹„ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ
- Django REST Framework, drf-spectacularë¥¼ ì´ìš©í•œ ë°±ì—”ë“œ API ê°œë°œ
- Dockerë¥¼ ì´ìš©í•œ ì»¨í…Œì´ë„ˆ í˜•íƒœë¡œì˜ ë°°í¬
- GitHub Actionsë¥¼ ì´ìš©í•œ CICD pipeline êµ¬ì¶•
- Terraformì„ ì´ìš©í•œ IaC êµ¬í˜„
- NCloudì—ì„œ ë¡œë“œë°¸ëŸ°ì„œë¥¼ í™œìš©í•œ í´ë¼ìš°ë“œ ë°©ì‹ì˜ ë°°í¬

<br>

## ğŸ“– í”„ë¡œì íŠ¸ ì£¼ìš” ê¸°ëŠ¥

### 0ï¸âƒ£ ê¶Œí•œ

- ëª¨ë“  ì‚¬ìš©ìëŠ” ë°ì´í„° ì¢…ë¥˜ì— ìƒê´€ì—†ì´ ì „ì²´ ë°ì´í„°ì— ëŒ€í•œ ì¡°íšŒ ê°€ëŠ¥
- ë‹¨ì¼ ë°ì´í„°ì— ëŒ€í•´ì„œëŠ” ë³¸ì¸ì´ ìƒì„±í•œ ê²ƒì— ëŒ€í•´ì„œë§Œ ì ‘ê·¼ ë° ë³€ê²½ ìš”ì²­ ê°€ëŠ¥ 

### 1ï¸âƒ£ ìœ ì €

- JWTë¥¼ ì´ìš©í•œ í† í° ì¸ì¦
- ì‚¬ìš©ìëŠ” ì „ì²´ ìœ ì € ì •ë³´ ì¡°íšŒ ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” ì¡°ê±´ì— ë”°ë¥¸ ìœ ì € ì •ë³´ ê²€ìƒ‰ ê°€ëŠ¥

### 2ï¸âƒ£ í”„ë¡œí•„

- ì‚¬ìš©ìëŠ” ì „ì²´ í”„ë¡œí•„ ì¡°íšŒ ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” ë³¸ì¸ì˜ í”„ë¡œí•„ ìƒì„± ë° ìˆ˜ì • ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” ì¡°ê±´ì— ë”°ë¥¸ í”„ë¡œí•„ ê²€ìƒ‰ ê°€ëŠ¥

### 3ï¸âƒ£ ê²Œì‹œê¸€
- ì‚¬ìš©ìëŠ” ê²Œì‹œê¸€ ì‘ì„± ë° ê²Œì‹œ ì—¬ë¶€ ì„¤ì • ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” ì „ì²´ ê²Œì‹œê¸€ ì¡°íšŒ ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” ë³¸ì¸ì˜ ê²Œì‹œë¬¼ì„ ëª¨ì•„ ë³¼ ìˆ˜ ìˆìŒ
- ì‚¬ìš©ìëŠ” ë³¸ì¸ì˜ ê²Œì‹œë¬¼ì„ ìˆ˜ì • ë˜ëŠ” ì‚­ì œ ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” ì¡°ê±´ì— ë”°ë¥¸ ê²Œì‹œê¸€ ê²€ìƒ‰ ê°€ëŠ¥

### 4ï¸âƒ£ follow

- ì‚¬ìš©ìëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìë¥¼ follow í˜¹ì€ unfollow ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” following (ë‚´ê°€ followí•œ ì‚¬ëŒë“¤) ëª©ë¡ í™•ì¸ ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” follower (ë‚˜ë¥¼ followí•œ ì‚¬ëŒë“¤) ëª©ë¡ í™•ì¸ ê°€ëŠ¥
- ì‚¬ìš©ìëŠ” followí•œ ì‚¬ëŒë“¤ì´ ì˜¬ë¦° ê²Œì‹œë¬¼ì„ ëª¨ì•„ ë³¼ ìˆ˜ ìˆìŒ

<br>

## ğŸ¤ Infra

### ğŸ–¥ GitHub Repository

**ì½”ë“œ ë° ë²„ì „ ê´€ë¦¬**

- ì‘ì—… í™˜ê²½ ë³„ Branch ë¶„ë¦¬

| Branch | ìš©ë„                       | Merge to         |
|-------|--------------------------|------------------|
| `feat`  | ê¸°ëŠ¥ ê°œë°œ ë° í…ŒìŠ¤íŠ¸              | `develop` branch |
| `develop` | ì •ìƒ ë™ì‘ í™•ì¸ ë° ë²„ê·¸ ìˆ˜ì •         |  `main` branch   |
| `main`  | ì„œë¹„ìŠ¤ ë°°í¬                   | -                |

<br>

### ğŸš¥ GitHub Actions

**ì§€ì†ì  í†µí•© (CI) ë° ì§€ì†ì  ë°°í¬ (CD)ë¥¼ êµ¬ì¶•**

**1ï¸âƒ£ CI**

| ë¶„ë¥˜    | ì„¤ëª…                                                                      |
|-------|:------------------------------------------------------------------------|
| ì¡°ê±´    | `feature` ë¸Œëœì¹˜ë¡œ pushë˜ì—ˆì„ ë•Œ                                                  |
| ì§„í–‰    | - í…ŒìŠ¤íŠ¸ ì§„í–‰ <br> - í…ŒìŠ¤íŠ¸ ì •ìƒ ì™„ë£Œ ì‹œ NCRë¡œ ì´ë¯¸ì§€ `push` <br> - ì›ê²© ë¦¬í¬ì§€í† ë¦¬ì— í•´ë‹¹ branch ìƒì„± |
| í™•ì¸ ëŒ€ìƒ | - ëª¨ë“  íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ <br> - ë‹¨, `infra` ë° `script` ë””ë ‰í† ë¦¬ ë° ê·¸ í•˜ìœ„ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ì€ ì œì™¸         |

**2ï¸âƒ£ CD to staging**

| ë¶„ë¥˜    | ì„¤ëª…                                                                                                                                                |
|-------|:--------------------------------------------------------------------------------------------------------------------------------------------------|
| ì¡°ê±´    | - `feature` ë¸Œëœì¹˜ì—ì„œ `develop` ë¸Œëœì¹˜ë¡œì˜ `Pull Request`ê°€ ì™„ë£Œë˜ì–´ ì½”ë“œê°€ `merge` ë˜ì—ˆì„ ë•Œ                                                                          |
| ì§„í–‰    | - `staging` stageì˜ `django` ì„œë²„ë¡œ ë°°í¬ <br> - ë°°í¬ëŠ” NCR Imageë¥¼ í†µí•œ ì»¨í…Œì´ë„ˆ í˜•íƒœë¡œ ì§„í–‰                                                                            |
| í™•ì¸ ëŒ€ìƒ | - ëª¨ë“  íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ <br> - ë‹¨, `docker` , `infra` , `script` ë””ë ‰í† ë¦¬ ë° ê·¸ í•˜ìœ„ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ë¥¼ ì œì™¸ <br> - .github/workflows ë‚´ ìê¸° ìì‹ (CD_dev.yaml)ì„ ì œì™¸í•œ ë‹¤ë¥¸ ì›Œí¬í”Œë¡œìš° íŒŒì¼ ì œì™¸  |

**3ï¸âƒ£ CD to production**

| ë¶„ë¥˜    | ì„¤ëª…                                                                                                                                          |
|-------|:--------------------------------------------------------------------------------------------------------------------------------------------|
| ì¡°ê±´    | - `develop` ë¸Œëœì¹˜ì—ì„œ `main` ë¸Œëœì¹˜ë¡œì˜ `Pull Request`ê°€ ì™„ë£Œë˜ì–´ ì½”ë“œê°€ `merge` ë˜ì—ˆì„ ë•Œ                                                                               |
| ì§„í–‰    | - `prod` stageì˜ `django` ì„œë²„ë¡œ ë°°í¬ <br> - ë°°í¬ëŠ” NCR Imageë¥¼ í†µí•œ ì»¨í…Œì´ë„ˆ í˜•íƒœë¡œ ì§„í–‰                                                                            |
| í™•ì¸ ëŒ€ìƒ | - ëª¨ë“  íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ <br> - ë‹¨, `docker` , `infra` , `script` ë””ë ‰í† ë¦¬ ë° ê·¸ í•˜ìœ„ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ë¥¼ ì œì™¸ <br> - .github/workflows ë‚´ ìê¸° ìì‹ (CD_main.yaml)ì„ ì œì™¸í•œ ë‹¤ë¥¸ ì›Œí¬í”Œë¡œìš° íŒŒì¼ ì œì™¸ |

<br>

### â›µ Docker
**ì»¨í…Œì´ë„ˆí™”ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ë¥¼ ìƒì„± ë° ê´€ë¦¬**

- ë°°í¬ ì‹œ, ì´ë¯¸ì§€ ë²„ì „ ê´€ë¦¬ë¥¼ ìœ„í•˜ì—¬ `TIMESTAMP` Ver. ê³¼ `latest` Ver. ë¥¼ ë™ì‹œì— ìƒì„±
- ìƒì„±ëœ ì´ë¯¸ì§€ëŠ” í´ë¼ìš°ë“œ í™˜ê²½(NCloud Container Registry)ì— Push
- ë°°í¬ ì‹œ `Latest` Ver. ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ë©°, ë¡¤ë°± í˜¹ì€ ë¡œê·¸ í™•ì¸ ì‹œ `TIMESTAMP` Ver. ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©

<br> 

### ğŸ’» Terraform

**í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ì¸í”„ë¼ë¥¼ ì½”ë“œë¡œ ê´€ë¦¬ ë° í”„ë¡œë¹„ì €ë‹**

**Shared Module**
- `Network` : VPC, Subnet ë¦¬ì†ŒìŠ¤ ìƒì„±
- `Server` : Access Group, Network Interface, Init Script, Server ë° ê´€ë ¨ ë¦¬ì†ŒìŠ¤ ìƒì„±
- `LoadBalancer` : Target Group, LoadBalancer ë° ê´€ë ¨ ë¦¬ì†ŒìŠ¤ ìƒì„±

**Child Module**
- `Staging` : `develop` ë¸Œëœì¹˜ ì—ì„œ ê´€ë¦¬ë˜ëŠ” ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `ìŠ¤í…Œì´ì§•` í™˜ê²½ì˜ í´ë¼ìš°ë“œ ë¦¬ì†ŒìŠ¤ë¥¼ ë°°í¬
- `Prod` :  `main` ë¸Œëœì¹˜ ì—ì„œ ê´€ë¦¬ë˜ëŠ” ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `í”„ë¡œë•ì…˜` í™˜ê²½ì˜ í´ë¼ìš°ë“œ ë¦¬ì†ŒìŠ¤ë¥¼ ë°°í¬

<br>

### â›… NCloud

**í´ë¼ìš°ë“œ ë¦¬ì†ŒìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ë¥¼ SaaS í˜•íƒœë¡œ ì œê³µ**


<br>

## ğŸª“ ì£¼ìš” ì„¤ì¹˜ íŒ¨í‚¤ì§€/ëª¨ë“ˆ

|   ì¢…ë¥˜    |               ì´ë¦„                |   ë²„ì „   |
|:---------:|:---------------------------------:|:--------:|
| Language  |            **python**             |   3.11   |
| Framework |            **Django**             |  4.2.4   |
| Database  |          **PostgreSQL**           |    13    |
|  Library  |           **gunicorn**            |  21.2.0  |
|  Library  |        **psycopg2-binary**        |  2.9.7   |
|  Library  |      **djangorestframework**      |  3.14.0  |
|  Library  | **djangorestframework-simplejwt** |  5.3.0   |
|  Library  |         **django-filter**         |   23.2   |
|  Library  |         **django-taggit**         |  4.0.0   |
|  Library  |        **drf-spectacular**        |  0.26.4  |
|  Library  |    **drf-spectacular-sidecar**    | 2023.9.1 |
|  Library  |             **boto3**             | 1.28.44  |
|  Library  |        **django-storages**        |   1.14   |
|  Library  |            **Pillow**             |  10.0.0  |

<br> 

## ğŸ“‹ Database Schema

### ğŸ’¾ User

| Column Name      | Data Type               | Constraint                                                       |
|------------------|-------------------------|------------------------------------------------------------------|
| **id**           | INTEGER                 | PRIMARY KEY                                                      |
| **email**        | VARCHAR(max_length=100) | UNIQUE , NOT NUL                                                 |
| **fullname**     | VARCHAR(max_length=30)  | NOT NULL                                                         |
| **phone**        | VARCHAR(max_length=30)  | UNIQUE,  NOT NULL                                                |
| **password**     | VARCHAR(max_length=100) |                                                                  |
| **is_admin**     | BOOLEAN                 | NOT NULL, DEFAULT : False                                        |
| **is_superuser** | BOOLEAN                 | NOT NULL, DEFAULT : False                                        |
| **is_active**    | BOOLEAN                 | NOT NULL, DEFAULT : True                                         |
| **last_login**   | DATETIME                | NULL                                                             |
| **created_at**   | DATETIME                | DEFAULT CURRENT_TIMESTAMP, NOT NULL                              |
| **updated_at**   | DATETIME                | DEFAULT CURRENT_TIMESTAMP, ON UPDATE CURRENT_TIMESTAMP, NOT NULL |

### ğŸ’¾ Profile

| Column Name    | Data Type               | Constraint                                                       |
|----------------|-------------------------|------------------------------------------------------------------|
| **id**         | INTEGER                 | PRIMARY KEY                                                      |
| **user**       | INTEGER                 | FOREIGN KEY REFERENCES Users(user_id), NOT NULL                  |
| **nickname**   | VARCHAR(max_length=30)  | UNIQUE, NOT NULL                                                 |
| **birthday**   | DATE                    | NOT NULL                                                         |
| **image_url**  | VARCHAR(max_length=255) | NULL                                                             |
| **is_public**  | BOOLEAN                 | NOT NULL, DEFAULT : False                                        |
| **is_active**  | BOOLEAN                 | NOT NULL, DEFAULT : True                                         |
| **created_at** | DATETIME                | DEFAULT CURRENT_TIMESTAMP, NOT NULL                              |
| **updated_at** | DATETIME                | DEFAULT CURRENT_TIMESTAMP, ON UPDATE CURRENT_TIMESTAMP, NOT NULL |

### ğŸ’¾ Post

| Column Name    | Data Type               | Constraint                                                       |
|----------------|-------------------------|------------------------------------------------------------------|
| **id**         | INTEGER                 | PRIMARY KEY                                                      |
| **title**      | VARCHAR(max_length=250) | NOT NULL                                                         |                                                                  |
| **slug**       | VARCHAR(max_length=250) | UNIQUE, NOT NULL                                                 |
| **author**     | INTEGER                 | FOREIGN KEY REFERENCES Users(user_id), NOT NULL                  |
| **body**       | TEXT                    | NOT NULL                                                         |
| **status**     | INTEGER                 | NOT NULL, DEFAULT : 0                                            |
| **publish**    | DATETIME                | DEFAULT CURRENT_TIMESTAMP,NOT NULL                               |
| **created_at** | DATETIME                | DEFAULT CURRENT_TIMESTAMP, NOT NULL                              |
| **updated_at** | DATETIME                | DEFAULT CURRENT_TIMESTAMP, ON UPDATE CURRENT_TIMESTAMP, NOT NULL |

### ğŸ’¾ Follow

| Column Name    | Data Type | Constraint                                      |
|----------------|-----------|-------------------------------------------------|
| **id**         | INTEGER   | PRIMARY KEY                                     |
| **user_from**  | INTEGER   | FOREIGN KEY REFERENCES Users(user_id), NOT NULL |
| **user_to**    | INTEGER   | FOREIGN KEY REFERENCES Users(user_id), NOT NULL |
| **created_at** | DATETIME  | DEFAULT CURRENT_TIMESTAMP, NOT NULL             |

### ğŸ’¾ Content_type

| Column Name   | Data Type                | Constraint  |
|---------------|--------------------------|-------------|
| **id**        | INTEGER                  | PRIMARY KEY |
| **app_label** | VARCHAR (max_length=100) | NOT NULL    |
| **model**     | VARCHAR (max_length=100) | NOT NULL    |

### ğŸ’¾ Tag

| Column Name | Data Type                | Constraint  |
|-------------|--------------------------|-------------|
| **id**      | INTEGER                  | PRIMARY KEY |
| **name**    | VARCHAR (max_length=100) | NOT NULL    |
| **slug**    | VARCHAR (max_length=100) | NOT NULL    |

### ğŸ’¾ Taggeditem

| Column Name         | Data Type | Constraint                                                     |
|---------------------|-----------|----------------------------------------------------------------|
| **id**              | INTEGER   | PRIMARY KEY                                                    |
| **object_id**       | INTEGER   |                                                                |
| **content_type_id** | INTEGER   | FOREIGN KEY REFERENCES Content_type(content_type_id), NOT NULL |
| **tag_id**          | INTEGER   | FOREIGN KEY REFERENCES Tag(tag_id), NOT NULL                   |

<br>

## ğŸ“… ERD

![image](https://github.com/likelion-backend-6th/TrackProject_1_ChoiSeonWoo/assets/104040502/9d266776-e2c1-4777-b169-8cd39a62b265)

<br>

## API ëª…ì„¸ì„œ
> í•˜ë‹¨ Notion ë§í¬ë¥¼ í†µí•´ ì ‘ì†í•˜ì—¬ í™•ì¸ ê°€ëŠ¥

![API_docs](https://github.com/likelion-backend-6th/TrackProject_1_ChoiSeonWoo/assets/104040502/b802e562-7915-4b6b-862e-67b6051c16ed)




<br>

## ë°°í¬ URL

### [ğŸš§ `staging` Server URL](http://be-lb-staging-19480782-5e27276c4a42.kr.lb.naverncp.com/)

> [ğŸ“œ `OpenAPI` URL](http://be-lb-staging-19480782-5e27276c4a42.kr.lb.naverncp.com/api/docs/)

### [ğŸ³â€ğŸŒˆ `production` Server URL](http://be-lb-prod-19480757-e92e545ff666.kr.lb.naverncp.com)

> [ğŸ“œ `OpenAPI` URL](http://be-lb-prod-19480757-e92e545ff666.kr.lb.naverncp.com/api/docs/)



<br>

## ğŸ“‘ Check List

### 0ï¸âƒ£0ï¸âƒ£ DB & APIì„¤ê³„

- [x]  DB ì„¤ê³„
- [x]  API ì„¤ê³„

### 0ï¸âƒ£1ï¸âƒ£ ì´ˆê¸° ì…‹íŒ…

- [x]  github ê´€ë ¨ ì„¤ì •
- [x]  ê°€ìƒí™˜ê²½ ë° ì¥ê³  ì„¤ì¹˜
- [x]  í”„ë¡œì íŠ¸ ë° ì£¼ìš” ì•± ìƒì„±
- [x]  `gunicorn` ì„¤ì •
- [x]  `requirements.txt` ì‘ì„±
- [x]  stageì— ë”°ë¥¸ ì„¤ì • íŒŒì¼ ë¶„ë¦¬
- [x]  í™˜ê²½ë³€ìˆ˜ ê´€ë ¨ ë””ë ‰í† ë¦¬ ë° íŒŒì¼ ìƒì„±

### 0ï¸âƒ£2ï¸âƒ£ Docker ì…‹íŒ…

- [x]  Dockerfile for Django - ì‘ì„±
- [x]  ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ì‘ì„±
- [x]  Django í”„ë¡œì íŠ¸ì—ì„œ psycopg2 ì‚¬ìš© ì„¤ì •
- [x]  Dockerfile for nginx in ubuntu - ì‘ì„±
- [x]  ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ì‘ì„±
- [x]  docker-compose.yml for local í™˜ê²½ - ì‘ì„±
- [x]  local í™˜ê²½ì—ì„œ ì‚¬ìš©í•  í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ì‘ì„±
- [x]  docker-compose.yml for test - ì‘ì„±

### 0ï¸âƒ£3ï¸âƒ£ Terraform ì…‹íŒ…

- [x]  ë””ë ‰í† ë¦¬ ë° íŒŒì¼ ìƒì„±
- [x]  ê¸°ë³¸ ëª¨ë“ˆ :Â `network`Â ì‘ì„±
- [x]  ê¸°ë³¸ ëª¨ë“ˆ :Â `server`Â ì‘ì„±
- [x]  ê¸°ë³¸ ëª¨ë“ˆ :Â `loadBalancer`Â ì‘ì„±
- [x]  ì„œë²„ ëª¨ë“ˆ :Â `staging`Â ì‘ì„±
- [x]  ì„œë²„ ëª¨ë“ˆ :Â `prod`Â ì‘ì„±
- [x]  ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
- [x]  SSH providerë¥¼ ì´ìš©í•œ ë°°í¬
- [x]  ì •ìƒ ìƒì„± ë° ë°°í¬ í™•ì¸

### 0ï¸âƒ£4ï¸âƒ£ CI/CD ì…‹íŒ…

- [x]  github repository - Settings - Secrets and variables ì„¤ì •
- [x]  github í™˜ê²½ ì„¤ì • - `branch protection rule`
- [x]  CI : feature ë¸Œëœì¹˜ë¡œ push ì´ë²¤íŠ¸ ë°œìƒ ì‹œ
- [x]  CD : develop ë¸Œëœì¹˜ë¡œ PRì´ ì™„ë£Œ ì‹œ staging ì„œë²„ë¡œ ë°°í¬
- [x]  CD : main ë¸Œëœì¹˜ë¡œ PRì´ ì™„ë£Œ ì‹œ prod ì„œë²„ë¡œ ë°°í¬
- [x]  Django ì•± ì´ë¯¸ì§€ êµì²´ (ë¡œì»¬/ì›ê²© í™˜ê²½ ë° NCR)

### 0ï¸âƒ£5ï¸âƒ£ Model

- [x]  Profile ëª¨ë¸ ìƒì„±
- [x]  Follow ëª¨ë¸ ìƒì„±
- [x]  Post ëª¨ë¸ ìƒì„±
- [x]  Admin siteì— ëª¨ë¸ ë“±ë¡
- [x]  ë¡œì»¬ í™˜ê²½ì—ì„œ docker-composeë¡œ í…ŒìŠ¤íŠ¸
- [x]  Post ëª¨ë¸ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

### 0ï¸âƒ£6ï¸âƒ£ User

- [x]  íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ì…‹íŒ… - DRF, DRF Spectacular ì™¸
- [x]  íšŒì›ê°€ì… ê¸°ëŠ¥ êµ¬í˜„
- [x]  íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸
- [x]  ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„
- [x]  ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
- [x]  ìœ ì € C/U/D ê¸°ëŠ¥ êµ¬í˜„
- [x]  ìœ ì € C/U/D ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [x]  í”„ë¡œí•„ C/R/U/D ê¸°ëŠ¥ êµ¬í˜„
- [x]  í”„ë¡œí•„ C/R/U/D ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [x]  íŒ”ë¡œìš° ê¸°ëŠ¥ êµ¬í˜„
- [x]  íŒ”ë¡œìš° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

### 0ï¸âƒ£7ï¸âƒ£ Post

- [x]  ê¶Œí•œ í™•ì¸ í´ë˜ìŠ¤ ë¦¬íŒ©í† ë§
- [x]  ê²Œì‹œê¸€ C/R/U/D ê¸°ëŠ¥ êµ¬í˜„
- [x]  ê²Œì‹œê¸€ ê´€ë ¨ í…ŒìŠ¤íŠ¸
- [x]  ë‚´ê°€ ì‘ì„±í•œ ê²Œì‹œê¸€ ëª¨ì•„ë³´ê¸° ê¸°ëŠ¥ êµ¬í˜„
- [x]  í•´ë‹¹ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [x]  ë‚´ê°€ íŒ”ë¡œìš°í•œ ìœ ì €ì˜ ê²Œì‹œê¸€ ëª¨ì•„ë³´ê¸° ê¸°ëŠ¥ êµ¬í˜„
- [x]  í•´ë‹¹ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

### 0ï¸âƒ£8ï¸âƒ£ OpenAPI

- [x]  drf-spectacular ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
- [x]  OpenAPI Swagger ìƒì„±
- [x]  ê° ì•±ë³„ drf-spectacular ì¶”ê°€ ì„¤ì •

### 0ï¸âƒ£9ï¸âƒ£ Image

- [x]  NCloud Object Storage ìƒì„±
- [x]  `boto3` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ë° `Object Storage` ì„¤ì •
- [x]  í”„ë¡œí•„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€
- [x]  í”„ë¡œí•„ ì´ë¯¸ì§€ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [x]  AWS S3 ë²„í‚· ìƒì„±
- [x]  `django-storages` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ë° `S3` ì„¤ì •
- [x]  ì •ì  íŒŒì¼ ì •ìƒ ì„œë¹™ í™•ì¸
- [x]  Terraform ì½”ë“œ ìˆ˜ì •

### 1ï¸âƒ£0ï¸âƒ£ Refactor

- [x]  Common - Permission ìˆ˜ì •
- [x]  Users - Model ìˆ˜ì •
- [x]  Users - Serializer ìˆ˜ì •
- [x]  Users - View & Url ìˆ˜ì •
- [x]  Posts - Model ìˆ˜ì •
- [x]  Posts - Serializer ìˆ˜ì •
- [x]  Posts - View & Url ìˆ˜ì •
- [x]  Test ì‹œë‚˜ë¦¬ì˜¤ ì‘ì„±
- [x]  Test Code ì‘ì„± ë° ì‹¤í–‰



<br>

## ğŸ“Œ Notion

### ğŸ  1ì°¨ ì§„í–‰ ê´€ë ¨
- [00. (ğŸ“º PLAN) DB & API ì„¤ê³„](https://www.notion.so/browneyed/00-DB-API-2e7c2be0ed3b447cae64c1113a50f4ee?pvs=4)
- [01. (ğŸ— SETTING) ì´ˆê¸° ì…‹íŒ…](https://www.notion.so/browneyed/01-81b4ca5fab734a14b1e50bfe56b307ec?pvs=4)
- [02. (ğŸ° INFRA) Docker ì…‹íŒ…](https://www.notion.so/browneyed/02-Docker-54acd08e87744d1bb7edf096ce365e19?pvs=4)
- [03. (ğŸ° INFRA) Terraform ì…‹íŒ…](https://notion.so/1bc02cc29f784493be1a104edf900f9f)
- [04. (ğŸ— SETTING) CI/CD ì…‹íŒ…](https://notion.so/d4c0eef1aa734e3ca7aa3b7f23836902)
- [05. (ğŸ‘‘ FEATURE) Model](https://notion.so/06deff565c354917afc045f67113a1c4)
- [06. (ğŸ‘‘ FEATURE) User](https://notion.so/37b6c92d79074e2b8284a809fb3e6cd8)
- [07. (â“â— Q&A) Github Actions](https://notion.so/fd8c3a72303e4502bbe99aa52b7483e9)
- [08. (ğŸ BUG) Docker & CI/CD](https://notion.so/9a2d41b6042b466f90af5fe3589786a5)
- [09. (ğŸ BUG) Model](https://notion.so/fe769e41e06e43ce9e90348c67c81187)
- [10. (ğŸ‘‘ FEATURE) Post](https://notion.so/d3ec4bc1f1654d0797794085918721ef)
- [11. (ğŸ‘‘ FEATURE) OpenAPI](https://notion.so/820a1c6a6da34d9d89495378a0531799)
- [12. (ğŸ‘‘ FEATURE) IMAGE](https://notion.so/2d88d0e5590d46368c817d08c3967b20)
- [13. (â“â— Q&A) TestCode - Mocking](https://notion.so/de18bc5d422441859743351103a21aca)

### ğŸ• 2ì°¨ ì§„í–‰ ê´€ë ¨
- [14. (ğŸ— SETTING) 2ì°¨ í”„ë¡œì íŠ¸ ì¤€ë¹„](https://notion.so/9d5e7351a3d1459d8ab962f031586793)
- [15. (â“â— Q&A) Mocking (2)](https://notion.so/28565c259b02432687e46b71704a9735)
- [16. (ğŸ BUG) TestCode - Mocking](https://notion.so/ba4877b4c33e49909e28de18ab313dcb)
- [17. (ğŸ‘‘ FEATURE) Refactor](https://notion.so/3b5063b7350c4950bea326f0e0e13da2)


<br>


## ğŸ“  Porting Manual

**ì•„ë˜ ë‚´ìš©ì´ ì´ë¯¸ ì¤€ë¹„ëœ ìƒí™©ì„ ê°€ì •ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.**

> - NCloud ë° AWSì— ê°€ì…ëœ ê³„ì • ì¡´ì¬
> - NCloudì—ì„œ Administrator ê¶Œí•œì´ ë¶€ì—¬ëœ Sub Account/ì„œë¹„ìŠ¤ ê³„ì •ì´ ì¡´ì¬
> - AWSì—ì„œ Administrator ê¶Œí•œì´ ë¶€ì—¬ëœ IAM ì„œë¹„ìŠ¤ ê³„ì •ì´ ì¡´ì¬
> - NCloud Container Registryì— ìƒì„±í•œ Registryê°€ ì¡´ì¬ 


### 1. ì•„ë˜ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ `NCLOUD Object Storage` ë²„í‚·ê³¼ `AWS S3` ë²„í‚· ìƒì„±

- [NCloud Object Storage ë²„í‚· ìƒì„±](https://www.notion.so/browneyed/12-Image-2d88d0e5590d46368c817d08c3967b20?pvs=4#618e69a5cf6f4d0db92de94bb8a786a2)
  - Terraformì—ì„œ NCloud Object Storage ë¦¬ì†ŒìŠ¤ ìƒì„±ì„ ì§€ì›í•˜ì§€ ì•Šì•„ ìˆ˜ë™ìœ¼ë¡œ ìƒì„± (2023.09 ê¸°ì¤€)

- [AWS AWS S3 ë²„í‚· ìƒì„±](https://www.notion.so/browneyed/12-Image-2d88d0e5590d46368c817d08c3967b20?pvs=4#22e50e4b4f7f4c05983056ed0c3c25b1)
  - ì‹œê°„ê´€ê³„ìƒ AWS S3 ë²„í‚· ìƒì„±ì˜ ê²½ìš° IaC ëŒ€ìƒì—ì„œ ì œì™¸ â†’ 2ì°¨ì—ì„œì‘ì—… ì˜ˆì •

### 2. git clone í›„ ì•„ë˜ ìˆœì„œëŒ€ë¡œ ì§„í–‰

> `staging` ì„œë²„ í™˜ê²½ êµ¬ì¶•ë§Œì„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±


**a.`.envs` í´ë” í•˜ìœ„ì— `prod` í´ë” ìƒì„± í›„, í•´ë‹¹ í´ë” í•˜ìœ„ì— `prod` íŒŒì¼ ìƒì„±**

```bash
# NCloud -------------------------------
NCP_ACCESS_KEY=<NCloud Sub Account ê³„ì •ì˜ Access Key>
NCP_SECRET_KEY=<NCloud Sub Account ê³„ì •ì˜ Secret Key>
NCP_S3_ENDPOINT_URL=https://kr.object.ncloudstorage.com
NCP_S3_REGION_NAME=kr-standard
NCP_S3_BUCKET_NAME=<NCloud Object Storageì—ì„œ ìƒì„±í•œ ë²„í‚· ì´ë¦„>
# AWS ----------------------------------
AWS_ACCESS_KEY_ID=<AWS IAM ê³„ì •ì˜ Access Key>
AWS_SECRET_ACCESS_KEY=<AWS IAM ê³„ì •ì˜ Access Key>
AWS_REGION=ap-northeast-2
AWS_STORAGE_BUCKET_NAME=<1ì—ì„œ ìƒì„±í•œ AWS S3 ë²„í‚· ì´ë¦„>
```

**b. docker image ìƒì„± ë° NCloud Container Registry ë¡œê·¸ì¸ í›„ push**

- NCloud Container Registry ë¡œê·¸ì¸
```
docker login <Sub Account Id>.kr.ncr.nturss.com
```
- Django ì•± ì´ë¯¸ì§€ ìƒì„±
```
docker build -t <Sub Account Id>.kr.ncr.nturss.com/<ì´ë¯¸ì§€íƒœê·¸>:latest -f docker/Dockerfile_dj .
```
- ìƒì„±í•œ ì´ë¯¸ì§€ë¥¼ NCloud Container Registry ë¡œê·¸ì¸
```
docker push <Sub Account Id>.kr.ncr.nturss.com/<ì´ë¯¸ì§€íƒœê·¸>:latest
```

**c. https://djecrety.ir/ ì ‘ì† â†’ `Generate` í´ë¦­ > `Django Secret Key` ê°€ ìë™ ë³µì‚¬ë¨**

- ì–´ë”˜ê°€ì— ë¶™ì—¬ë„£ê¸° í•˜ì—¬ ë³´ê´€í•´ë‘˜ ê²ƒ

**d. `infra/NCP/stage/staging` í´ë” ë‚´ì— `terraform.tfvars` íŒŒì¼ ìƒì„± ë° ì‘ì„±**

```bash
# --------------------------------------------
# Remote Server Account Info
username="<ì›ê²©ì„œë²„ ì ‘ì†ì‹œ ì‚¬ìš©í•  ê³„ì •ì˜ ì‚¬ìš©ìëª…>"
password="<ì›ê²©ì„œë²„ ì ‘ì†ì‹œ ì‚¬ìš©í•  ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸>"
# --------------------------------------------
# DB Info
postgres_db="<PostgreSQL db ì„œë²„ ì´ë¦„>"
postgres_user="<PostgreSQL db ê³„ì • ì‚¬ìš©ìëª…>"
postgres_password="<PostgreSQL db ê³„ì • ë¹„ë°€ë²ˆí˜¸>"
postgres_volume="<PostgreSQL dbì— ì‚¬ìš©í•  Volumeëª…>"
db_container_name="<PostgreSQL db ì»¨í…Œì´ë„ˆëª…>"
# --------------------------------------------
# Django Info
django_settings_module="config.settings.staging"
django_secret_key="'<aì—ì„œ ìƒì„±í•œ Django Secret Key ì‚½ì…>'"
django_container_name="<Django ì•± ì»¨í…Œì´ë„ˆëª…>"
# --------------------------------------------
# NCP Info
ncr_host="browneyed.kr.ncr.ntruss.com"
ncr_image="swns:latest"
ncp_access_key="<NCloud Sub Account ê³„ì •ì˜ Access Key>"
ncp_secret_key="<NCloud Sub Account ê³„ì •ì˜ Secret Key>"
ncp_lb_domain="lb-init-domain.com"
ncp_s3_endpoint_url="https://kr.object.ncloudstorage.com"
ncp_s3_region_name="kr-standard"
ncp_s3_bucket_name="<NCloud Object Storageì—ì„œ ìƒì„±í•œ ë²„í‚· ì´ë¦„>"
# --------------------------------------------
# AWS Info
aws_access_key_id="<AWS IAM ê³„ì •ì˜ Access Key>"
aws_secret_access_key="<AWS IAM ê³„ì •ì˜ Access Key>"
aws_region="ap-northeast-2"
aws_storage_bucket_name="<1ì—ì„œ ìƒì„±í•œ AWS S3 ë²„í‚· ì´ë¦„>"
```

**e. Terraform ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ì¸í”„ë¼ êµ¬ì¶•**

```
cd infra/NCP/stage/staging
```
```
terraform init
```
```
terraform apply
```

**f. `terraform apply` ì˜ ê²°ê³¼ë¡œ, í„°ë¯¸ë„ ì°½ì— ì•„ë˜ì™€ ê°™ì´ ì¶œë ¥ë¨**

```
Outputs:

be_lb_domain = "<Load Balancer ì£¼ì†Œ>"
be_public_ip = "<Django ì„œë²„ Host ì£¼ì†Œ>"
db_public_ip = "<PostgreSQL DB ì„œë²„ Host ì£¼ì†Œ>"
``` 

**g. ssh ë¥¼ ì´ìš©í•˜ì—¬ Django ì„œë²„ì— ì›ê²© ì ‘ì†**

> `<ì›ê²©ì„œë²„ ì ‘ì†ì‹œ ì‚¬ìš©í•  ê³„ì • ì •ë³´>` ëŠ” ìœ„ì—ì„œ `d`ì—ì„œ ì§€ì •í•œ ë°ì´í„°ë“¤ì„ ì‚¬ìš©

```
ssh <ì›ê²©ì„œë²„ ì ‘ì†ì‹œ ì‚¬ìš©í•  ê³„ì •ì˜ ì‚¬ìš©ìëª…>@<Django ì„œë²„ Host ì£¼ì†Œ>
```
```
<ì›ê²©ì„œë²„ ì ‘ì†ì‹œ ì‚¬ìš©í•  ê³„ì •ì˜ ë¹„ë°€ë²ˆí˜¸> ì…ë ¥ í›„ Enter
```

**h. `.env` íŒŒì¼ ë‚´ `NCP_LB_DOMAIN` ë‚´ìš© ìˆ˜ì •**

> ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ë„ë©”ì¸ì´ ì´ë¯¸ ì§€ì •ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë¶ˆí•„ìš”í•œ ê³¼ì •

- `f` ì—ì„œ í™•ì¸í•œ `Load Balancer ì£¼ì†Œ`ë¡œ ì§€ì •
```
vi .env
```
```
NCP_LB_DOMAIN=<Load Balancer ì£¼ì†Œ>
```

**i. ë³€ê²½ëœ í™˜ê²½ë³€ìˆ˜ ì ìš©**

- `.env` íŒŒì¼ ë¦¬ë¡œë“œ ë° í•´ë‹¹ ë‚´ìš©ì„ `.bash_aliases` ì—ë„ ì ìš©í•˜ê¸° ìœ„í•´ ì•„ë˜ ëª…ë ¹ì–´ ì‹¤í–‰
```
source ~/.bash_aliases
```

**j. ì‹¤í–‰ ì¤‘ì¸ Django ì•± ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ì‚­ì œ í›„ ì¬ì‹¤í–‰**

- ì´ë¯¸ `alias` ê°€ `.bash_aliases` íŒŒì¼ ë‚´ì— ì§€ì •ë˜ì–´ ìˆì–´ìŒ

```
# django ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ì»¨í…Œì´ë„ˆ ì‚­ì œ
dstrm
```
```
# í™˜ê²½ë³€ìˆ˜ë¥¼ ë°˜ì˜í•˜ì—¬ django ì»¨í…Œì´ë„ˆ ì‹¤í–‰
drerun
```

**k. `f` ì—ì„œ í™•ì¸í•œ `Load Balancer ì£¼ì†Œ`ë¡œ ì ‘ì†**

- ì •ìƒ ì ‘ì† ë¨ì„ í™•ì¸ ê°€ëŠ¥


<br>

## ğŸš§ 2ì°¨ì—ì„œ ì‘ì—… ì˜ˆì • ëª©ë¡

**ìš°ì„ ìˆœìœ„ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±**

- [ ] ìƒì„±/ê·¸ì™¸ ëª©ì ì˜ Serializer ë¶„ë¦¬
- [ ] API ëª…ì„¸ì„œ ì¶”ê°€ ì‘ì„± (Request, Response)
- [ ] ë°ì´í„° ìœ íš¨ì„± ê²€ì¦ ì¶”ê°€ ë° í…ŒìŠ¤íŠ¸ ì½”ë“œ ê°œì„ 
- [ ] ì¿¼ë¦¬ ì†ë„ ê°œì„ 
- [ ] API Endpoint ê°œì„ 
- [ ] ì½”ë“œ ë¦¬íŒ©í† ë§
- [ ] Infra Architecture Diagram ì‘ì„±
- [ ] ëŒ“ê¸€, ì¢‹ì•„ìš” ê¸°ëŠ¥ ì¶”ê°€



<br>
<br>
